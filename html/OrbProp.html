
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>OrbProp</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-02-14"><meta name="DC.source" content="OrbProp.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="comment">% Functions compiled and GUI developed by Damon P. DeLuca, USN CIV</span>
<span class="comment">% Email: damondeluca@gmail.com</span>
<span class="comment">%</span>
<span class="comment">% NOTE: Output generated by this program has not been validated, other than</span>
<span class="comment">% ensuring close agreement with AGI STK results.</span>
<span class="comment">%</span>
<span class="comment">% This script runs the SGP4 propagator using the manual method, afspc, with</span>
<span class="comment">% WGS72 ellipsoid. SPG4 output in ManualOut.out is transformed from TEME</span>
<span class="comment">% to ECEF using functions from David Vallado. The transformation teme2ecef</span>
<span class="comment">% is executed for each line of output in ManualOutput.out.</span>
<span class="comment">%</span>
<span class="comment">% Input: See GUI. TLE input is a single two line file.</span>
<span class="comment">%</span>
<span class="comment">% Output:</span>
<span class="comment">%     Access_Summary.txt: Summary of visibility times from observers</span>
<span class="comment">%     location, with az/el/sr</span>
<span class="comment">%</span>
<span class="comment">%     Access_Transit.txt: Used for plotting ground tracks for passes in</span>
<span class="comment">%     Access_Summary.txt. Only visibility periods are included.</span>
<span class="comment">%     line number, lat, lon, alt (m), el(deg), az(degT), timevector</span>
<span class="comment">%</span>
<span class="comment">%     LLA_Transit.txt: Used for plotting ENTIRE ground track for period</span>
<span class="comment">%     specified in the GUI.</span>
<span class="comment">%</span>
<span class="comment">%     PolarPlot.png: Az-El polar plot of passes in Access_Summary.txt</span>
<span class="comment">%</span>
<span class="comment">%SGP4 functions were % downloaded from www.celestrak.com during the week</span>
<span class="comment">%of 18 JAN 2016. Credit below:</span>
<span class="comment">% Author:</span>
<span class="comment">%   Jeff Beck</span>
<span class="comment">%   beckja@alumni.lehigh.edu</span>

<span class="comment">% Version Info:</span>
<span class="comment">%   1.0 (051019) - Initial version from Vallado C++ version.</span>
<span class="comment">%   1.0 (aug 14, 2006) - update for paper</span>
<span class="comment">%   2.0 (apr 2, 2007) - update for manual operations</span>
<span class="comment">%   3.0 (3 jul, 2008) - update for opsmode operation afspc or improved</span>
<span class="comment">%   3.1 (2 dec, 2008) - fix tsince/1440.0 in jd update</span>



<span class="keyword">function</span> varargout = OrbProp(varargin)
<span class="comment">% ORBPROP MATLAB code for OrbProp.fig</span>
<span class="comment">%      ORBPROP, by itself, creates a new ORBPROP or raises the existing</span>
<span class="comment">%      singleton*.</span>
<span class="comment">%</span>
<span class="comment">%      H = ORBPROP returns the handle to a new ORBPROP or the handle to</span>
<span class="comment">%      the existing singleton*.</span>
<span class="comment">%</span>
<span class="comment">%      ORBPROP('CALLBACK',hObject,eventData,handles,...) calls the local</span>
<span class="comment">%      function named CALLBACK in ORBPROP.M with the given input arguments.</span>
<span class="comment">%</span>
<span class="comment">%      ORBPROP('Property','Value',...) creates a new ORBPROP or raises the</span>
<span class="comment">%      existing singleton*.  Starting from the left, property value pairs are</span>
<span class="comment">%      applied to the GUI before OrbProp_OpeningFcn gets called.  An</span>
<span class="comment">%      unrecognized property name or invalid value makes property application</span>
<span class="comment">%      stop.  All inputs are passed to OrbProp_OpeningFcn via varargin.</span>
<span class="comment">%</span>
<span class="comment">%      *See GUI Options on GUIDE's Tools menu.  Choose "GUI allows only one</span>
<span class="comment">%      instance to run (singleton)".</span>
<span class="comment">%</span>
<span class="comment">% See also: GUIDE, GUIDATA, GUIHANDLES</span>

<span class="comment">% Edit the above text to modify the response to help OrbProp</span>

<span class="comment">% Last Modified by GUIDE v2.5 01-Feb-2016 16:48:13</span>

<span class="comment">% Begin initialization code - DO NOT EDIT</span>
gui_Singleton = 1;
gui_State = struct(<span class="string">'gui_Name'</span>,       mfilename, <span class="keyword">...</span>
    <span class="string">'gui_Singleton'</span>,  gui_Singleton, <span class="keyword">...</span>
    <span class="string">'gui_OpeningFcn'</span>, @OrbProp_OpeningFcn, <span class="keyword">...</span>
    <span class="string">'gui_OutputFcn'</span>,  @OrbProp_OutputFcn, <span class="keyword">...</span>
    <span class="string">'gui_LayoutFcn'</span>,  [] , <span class="keyword">...</span>
    <span class="string">'gui_Callback'</span>,   []);
<span class="keyword">if</span> nargin &amp;&amp; ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
<span class="keyword">end</span>

<span class="keyword">if</span> nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
<span class="keyword">else</span>
    gui_mainfcn(gui_State, varargin{:});
<span class="keyword">end</span>
<span class="comment">% End initialization code - DO NOT EDIT</span>


<span class="comment">% --- Executes just before OrbProp is made visible.</span>
<span class="keyword">function</span> OrbProp_OpeningFcn(hObject, eventdata, handles, varargin)
<span class="comment">% This function has no output args, see OutputFcn.</span>
<span class="comment">% hObject    handle to figure</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
<span class="comment">% varargin   command line arguments to OrbProp (see VARARGIN)</span>

<span class="comment">% Choose default command line output for OrbProp</span>
handles.output = hObject;

<span class="comment">% Update handles structure</span>
guidata(hObject, handles);

<span class="comment">% UIWAIT makes OrbProp wait for user response (see UIRESUME)</span>
<span class="comment">% uiwait(handles.figure1);</span>


<span class="comment">% --- Outputs from this function are returned to the command line.</span>
<span class="keyword">function</span> varargout = OrbProp_OutputFcn(hObject, eventdata, handles)
<span class="comment">% varargout  cell array for returning output args (see VARARGOUT);</span>
<span class="comment">% hObject    handle to figure</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Get default command line output from handles structure</span>
varargout{1} = handles.output;


<span class="comment">% --- Executes on button press in run.</span>
<span class="keyword">function</span> run_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to run (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
<span class="comment">% script testmat.m</span>
<span class="comment">%</span>
<span class="comment">% This script tests the SGP4 propagator.</span>

<span class="comment">% Author:</span>
<span class="comment">%   Jeff Beck</span>
<span class="comment">%   beckja@alumni.lehigh.edu</span>

<span class="comment">% Version Info:</span>
<span class="comment">%   1.0 (051019) - Initial version from Vallado C++ version.</span>
<span class="comment">%   1.0 (aug 14, 2006) - update for paper</span>
<span class="comment">%   2.0 (apr 2, 2007) - update for manual operations</span>
<span class="comment">%   3.0 (3 jul, 2008) - update for opsmode operation afspc or improved</span>
<span class="comment">%   3.1 (2 dec, 2008) - fix tsince/1440.0 in jd update</span>

<span class="comment">% these are set in sgp4init</span>
<span class="keyword">global</span> tumin mu radiusearthkm xke j2 j3 j4 j3oj2 infile outfile

<span class="keyword">global</span> opsmode satrec startmfe stopmfe deltamin  tleloadflag

<span class="comment">% // ------------------------  implementation   --------------------------</span>
clear <span class="string">adum</span> <span class="string">grob</span> <span class="string">azob</span> <span class="string">HorEl</span> <span class="string">ElSR</span> <span class="string">ElGR</span>

mess=msgbox(<span class="string">'Please Wait...'</span>);

<span class="comment">%   add operation smode for afspc (a) or improved (i)</span>
<span class="comment">% opsmode= input('input opsmode afspc a, improved i ','s');</span>
opsmode= <span class="string">'a'</span>;

<span class="comment">%         //typerun = 'c' compare 1 year of full satcat data</span>
<span class="comment">%         //typerun = 'v' verification run, requires modified elm file with</span>
<span class="comment">%         //typerun = 'm' maunual operation- either mfe, epoch, or dayof yr</span>
<span class="comment">%         //              start stop and delta times</span>

<span class="comment">%     typerun = input('input type of run c, v, m: ','s');</span>
<span class="keyword">if</span> tleloadflag==0
    errordlg(<span class="string">'Select and Load TLE!'</span>);
    <span class="keyword">return</span>;
<span class="keyword">end</span>

typerun = <span class="string">'m'</span>;

<span class="keyword">if</span> (typerun == <span class="string">'m'</span>)
    <span class="comment">%     typeinput = input('input mfe, epoch (YMDHMS), or dayofyr approach, m,e,d:','s');</span>
    typeinput = <span class="string">'e'</span>;
<span class="keyword">else</span>
    typeinput = <span class="string">'e'</span>;
<span class="keyword">end</span>;

<span class="comment">%     whichconst = input('input constants 721, 72, 84 ');</span>

<span class="comment">%  whichconst = input('input constants 721, 72, 84 ');</span>
whichconst = 72;
rad = 180.0 / pi;
outfile = fopen(<span class="string">'ManualOutput.out'</span>, <span class="string">'wt'</span>);

<span class="comment">%         // ---------------- setup files for operation ------------------</span>
<span class="comment">%         // input 2-line element set file</span>
<span class="comment">%     infilename = input('input elset filename: ','s');</span>
<span class="comment">% infilename = 'JASON3_SGP4_test.tle';</span>


<span class="keyword">global</span> idebug dbgfile

<span class="comment">%        // ----------------- test simple propagation -------------------</span>

longstr1 = fgets(infile, 130);
<span class="keyword">while</span> ( (longstr1(1) == <span class="string">'#'</span>) &amp;&amp; (feof(infile) == 0) )
    longstr1 = fgets(infile, 130);
<span class="keyword">end</span>



<span class="comment">%         longstr2 = fgets(infile, 130);</span>
<span class="comment">%</span>
<span class="comment">%         if idebug</span>
<span class="comment">%             catno = strtrim(longstr1(3:7));</span>
<span class="comment">%             dbgfile = fopen(strcat('sgp4test.dbg.',catno), 'wt');</span>
<span class="comment">%             fprintf(dbgfile,'this is the debug output\n\n' );</span>
<span class="comment">%         end</span>
<span class="comment">%         %                // convert the char string to sgp4 elements</span>
<span class="comment">%         %                // includes initialization of sgp4</span>
<span class="comment">%         [satrec, startmfe, stopmfe, deltamin] = twoline2rv( whichconst, ...</span>
<span class="comment">%             longstr1, longstr2, typerun, typeinput);</span>
<span class="comment">%</span>
<span class="comment">%         %             fprintf(outfile, '%d xx\n', satrec.satnum);</span>
<span class="comment">%         %             fprintf(1,' %d\n', satrec.satnum);</span>

<span class="comment">%               // call the propagator to get the initial state vector value</span>
[satrec, ro ,vo] = sgp4 (satrec,  0.0);

<span class="comment">%             fprintf(outfile, ' %16.8f %16.8f %16.8f %16.8f %12.9f %12.9f %12.9f\n',...</span>
<span class="comment">%                  satrec.t,ro(1),ro(2),ro(3),vo(1),vo(2),vo(3));</span>
<span class="comment">%            fprintf(1, ' %16.8f %16.8f %16.8f %16.8f %12.9f %12.9f %12.9f\n',...</span>
<span class="comment">%                 satrec.t,ro(1),ro(2),ro(3),vo(1),vo(2),vo(3));</span>

tsince = startmfe;

<span class="comment">%                // check so the first value isn't written twice</span>
<span class="keyword">if</span> ( abs(tsince) &gt; 1.0e-8 )
    tsince = tsince - deltamin;
<span class="keyword">end</span>

<span class="comment">%                // loop to perform the propagation</span>
<span class="keyword">while</span> ((tsince &lt; stopmfe) &amp;&amp; (satrec.error == 0))

    tsince = tsince + deltamin;

    <span class="keyword">if</span>(tsince &gt; stopmfe)
        tsince = stopmfe;
    <span class="keyword">end</span>

    [satrec, ro, vo] = sgp4 (satrec,  tsince);
    <span class="keyword">if</span> (satrec.error &gt; 0)
        fprintf(1,<span class="string">'# *** error: t:= %f *** code = %3i\n'</span>, tsince, satrec.error);
    <span class="keyword">end</span>

    <span class="keyword">if</span> (satrec.error == 0)
        <span class="keyword">if</span> ((typerun ~= <span class="string">'v'</span>) &amp;&amp; (typerun ~= <span class="string">'c'</span>))
            jd = satrec.jdsatepoch + tsince/1440.0;
            [year,mon,day,hr,minute,sec] = invjday ( jd );

            <span class="comment">%Print the below for TEME state</span>
            fprintf(outfile,<span class="keyword">...</span>
                <span class="string">' %16.8f %16.8f %16.8f %12.9f %12.9f %12.9f %5i%3i%3i %2i %2i %9.6f \n'</span>,<span class="keyword">...</span>
                ro(1),ro(2),ro(3),vo(1),vo(2),vo(3),year,mon,day,hr,minute,sec );

            [p,a,ecc,incl,node,argp,nu,m,arglat,truelon,lonper ] = rv2coe (ro,vo,mu);
            <span class="comment">%Print the below for keplar elements</span>
            <span class="comment">%                         fprintf(outfile, ' %14.6f %8.6f %10.5f %10.5f</span>
            <span class="comment">%10.5f %10.5f %10.5f %10.5f %10.5f %5i%3i%3i %2i:%2i:%9.6f \n',...</span>
            <span class="comment">%                             p, ecc, incl, node, argp, nu, arglat, truelon, lonper,year,mon,day,hr,minute,sec );</span>
        <span class="keyword">else</span>
            jd = satrec.jdsatepoch + tsince/1440.0;
            [year,mon,day,hr,minute,sec] = invjday ( jd );

            fprintf(outfile, <span class="string">' %16.8f %16.8f %16.8f %16.8f %12.9f %12.9f %12.9f'</span>,<span class="keyword">...</span>
                tsince,ro(1),ro(2),ro(3),vo(1),vo(2),vo(3));
            <span class="comment">%                        fprintf(1, ' %16.8f %16.8f %16.8f %16.8f %12.9f</span>
            <span class="comment">%12.9f %12.9f \n',...</span>
            <span class="comment">%                            tsince,ro(1),ro(2),ro(3),vo(1),vo(2),vo(3));</span>

            [p,a,ecc,incl,node,argp,nu,m,arglat,truelon,lonper ] = rv2coe (ro,vo,mu);

            fprintf(outfile, <span class="string">' %14.6f %8.6f %10.5f %10.5f %10.5f %10.5f %10.5f %5i%3i%3i %2i:%2i:%9.6f \n'</span>,<span class="keyword">...</span>
                a, ecc, incl*rad, node*rad, argp*rad, nu*rad, m*rad,year,mon,day,hr,minute,sec );
        <span class="keyword">end</span>
    <span class="keyword">end</span> <span class="comment">%// if satrec.error == 0</span>

<span class="keyword">end</span> <span class="comment">%// while propagating the orbit</span>

<span class="keyword">if</span> (idebug &amp;&amp; (dbgfile ~= -1))
    fclose(dbgfile);
<span class="keyword">end</span>





fclose(infile);
fclose(outfile);



<span class="comment">%%%%Damon's code to calculate LLA</span>
dat=importdata(<span class="string">'ManualOutput.out'</span>);
datsiz=size(dat);
fileID=fopen(<span class="string">'ManualOutput.out'</span>);
data = textscan(fileID, <span class="string">'%f %f %f %f %f %f %f %f %f %f %f %f %*[^\n]'</span>);
<span class="comment">% data = textscan(fileID, '%f %f %f %f %f %f %f %f %f %*[^\n]');</span>

<span class="comment">%Open file for writing LLA</span>
outd=get(handles.outdiredit,<span class="string">'string'</span>);
outd2=strcat(outd,<span class="string">'/LLA_Transit.txt'</span>);
LLAoutfile = fopen(outd2, <span class="string">'wt'</span>);

<span class="comment">%Get vars for teme2ecef</span>
convrt = pi / (3600.0*180.0); <span class="comment">%arc sec to rad</span>
convrtm= (0.001*pi) /(180.0*3600.0);
xp=.0075*convrt;
yp=.2925*convrt; <span class="comment">%xp and yp from Naval observatory, 1/26/2016</span>
lod=0; <span class="comment">%Excess length of day</span>
dut1=0;
dat=0;
timezone=0;


<span class="comment">%Use below for TEME elements</span>
<span class="keyword">for</span> i=1:datsiz(1)
    <span class="comment">% [r(i,:) v(i,:)]=orb2rv(data{1,1}(i),data{1,2}(i),data{1,3}(i),data{1,4}(i),data{1,5}(i),...</span>
    <span class="comment">%     data{1,6}(i),data{1,7}(i),data{1,8}(i),data{1,9}(i));</span>
    r(i,:)=[data{1,1}(i),data{1,2}(i),data{1,3}(i)];
    v(i,:)=[data{1,4}(i),data{1,5}(i),data{1,6}(i)];
    a(i,1:3)=[0, 0, 0];

    <span class="comment">%Get time of the TEME line being processed</span>
    year=data{1,7}(i);
    mon=data{1,8}(i);
    day=data{1,9}(i);
    hr=data{1,10}(i);
    min=data{1,11}(i);
    sec=data{1,12}(i);

    <span class="comment">%Calc time vars for time of TEME line</span>
    [ut1, tut1, jdut1, utc, tai, tt, ttt, jdtt, tdb, ttdb, jdtdb, tcg, jdtcg, tcb, jdtcb ] <span class="keyword">...</span>
        = convtime ( year, mon, day, hr, min, sec, timezone, dut1, dat );

    <span class="comment">%Calc ECEF coordinate for TEME line using correct time</span>
    [recef(i,:),vecef(i,:),aecef(i,:)] = teme2ecef  ( r(i,:)',v(i,:)',a(i,:)',ttt,jdut1,lod,xp,yp );
    recef(i,:)=recef(i,:).*1000;
    R(i,1)=i;
    R(i,2:4)=recef(i,:);

    LLA(i,1:4)= ecefm2LLA(R(i,1:4));

    timform=datestr([data{1,7}(i),data{1,8}(i),data{1,9}(i),data{1,10}(i),data{1,11}(i),data{1,12}(i)]);
    fprintf(LLAoutfile, <span class="string">'%5i %8.4f %8.4f %10.3f \t %5i %3i %3i %2i %2i %9.6f \n'</span>,<span class="keyword">...</span>
        LLA(i,1),LLA(i,2),LLA(i,3),LLA(i,4),data{1,7}(i),data{1,8}(i),data{1,9}(i),data{1,10}(i),data{1,11}(i),data{1,12}(i));
<span class="keyword">end</span>
fclose(LLAoutfile);

<span class="comment">%Write ground track to KML file</span>
KMLplot(LLA);

<span class="comment">%</span>
<span class="comment">%   Calculations to determine visibility to TLE</span>

wgs84=[6378.137 0.081819190842622];
wgs8443=[8504.182667 0.081819190842622]; <span class="comment">%Used for radar horizon (4/3r earth)</span>

vlat=str2double(get(handles.oblat,<span class="string">'string'</span>)); <span class="comment">%viewer lat</span>
vlon=str2double(get(handles.oblon,<span class="string">'string'</span>)); <span class="comment">%viewer lon</span>
valt=str2double(get(handles.obalt,<span class="string">'string'</span>)); <span class="comment">%viewer alt m geodetic</span>

<span class="keyword">if</span> isempty(vlat)||isempty(vlon)||isempty(valt)
    errordlg(<span class="string">'Set Observer Location'</span>);
    <span class="keyword">return</span>;
<span class="keyword">end</span>

<span class="comment">%Calculate elevation and sr of object</span>
rngvec=ones(1,datsiz(1));
vlatvec=vlat*rngvec;
vlonvec=vlon*rngvec;
valtvec=valt/1000*rngvec;
[eob,srob,adum]=elevation(vlatvec',vlonvec',valtvec',LLA(:,2),LLA(:,3),LLA(:,4)./1000,<span class="string">'degrees'</span>,wgs84);
[grob,azob]=distance(vlatvec',vlonvec',LLA(:,2),LLA(:,3),wgs84,<span class="string">'degrees'</span>);

<span class="comment">%Calculate el of horizon from observer</span>
[HorEl, ElSR, ElGR] = GeoHorizonEl (vlat,vlon,valt); <span class="comment">%valt in m, SR and GR in km</span>

<span class="comment">% %Find lines where over the horizon</span>
<span class="comment">% othnums=find(eob&gt;HorEl);</span>
<span class="comment">% othnumssiz=size(othnums);</span>

<span class="comment">%Get sector constraints</span>
<span class="keyword">if</span> get(handles.sectcb,<span class="string">'value'</span>)==1
    maxE=str2double(get(handles.maxeledit,<span class="string">'string'</span>));
    minE=str2double(get(handles.mineledit,<span class="string">'string'</span>));
    laz=str2double(get(handles.lazedit,<span class="string">'string'</span>));
    raz=str2double(get(handles.razedit,<span class="string">'string'</span>));

    <span class="keyword">if</span> isempty(maxE)||isempty(minE)||isempty(laz)||isempty(raz)
        errordlg(<span class="string">'Set sector constraints!'</span>);
        <span class="keyword">return</span>;
    <span class="keyword">end</span>

    othnums1=find(eob&gt;=minE);
    othnums2=othnums1(find(eob(othnums1)&lt;=maxE));

    <span class="keyword">if</span> raz&lt;laz

        aztmp=360+raz;
        azobtempnumschange=find(azob&lt;=raz);
        azobtempnums=find(azob&gt;raz);
        azobtemp(azobtempnums)=azob(azobtempnums);
        azobtemp(azobtempnumschange)=azob(azobtempnumschange)+360;

        othnums3=othnums2(find(azobtemp(othnums2)&lt;=raz+360));
        othnums=othnums3(find(azobtemp(othnums3)&gt;=laz));

        othnumssiz=size(othnums);

    <span class="keyword">else</span>
        othnums3=othnums2(find(azob(othnums2)&gt;=laz));
        othnums=othnums3(find(azob(othnums3)&lt;=raz));

        othnumssiz=size(othnums);

    <span class="keyword">end</span>





<span class="keyword">else</span> <span class="comment">%write all points above horizon</span>
    <span class="comment">%Find lines where over the horizon</span>
    othnums=find(eob&gt;HorEl);
    othnumssiz=size(othnums);

<span class="keyword">end</span>

tm=clock;
tmf=datestr(clock);


<span class="comment">%Open two files for writing</span>
outd=get(handles.outdiredit,<span class="string">'string'</span>);
outd2=strcat(outd,<span class="string">'/Access_Transit.txt'</span>);
acctrak = fopen(outd2, <span class="string">'wt'</span>);

outd=get(handles.outdiredit,<span class="string">'string'</span>);
outd2=strcat(outd,<span class="string">'/Access_Summary.txt'</span>);
othfile = fopen(outd2, <span class="string">'wt'</span>);




<span class="comment">%</span>
<span class="comment">% fprintf(othfile, 'Satellite Access File Created %5i/%2i/%2i %2i:%2i \n',...</span>
<span class="comment">%     tm(1),tm(2),tm(3),tm(4),tm(5));</span>
fprintf(othfile, <span class="string">'Satellite GEO LOS Access File Created: %20s \n'</span>,<span class="keyword">...</span>
    tmf);
fprintf(othfile, <span class="string">'Satellite ID: %5i \n \n'</span>, satrec.satnum);
fprintf(othfile, <span class="string">'Viewer location: %6.4f Lat, %8.4f Lon, %6.1f m geodetic \n \n'</span>,vlat,vlon,valt);

<span class="keyword">if</span> get(handles.sectcb,<span class="string">'value'</span>)==1
    fprintf(othfile, <span class="string">'Sector Max El (degs): %3.1f \n'</span>, maxE);
    fprintf(othfile, <span class="string">'Sector Min El (degs): %3.1f \n'</span>, minE);
    fprintf(othfile, <span class="string">'Sector Left (degsT): %3.1f \n'</span>, laz);
    fprintf(othfile, <span class="string">'Sector Right (degsT): %3.1f \n \n'</span>, raz);
<span class="keyword">end</span>



fprintf(othfile, <span class="string">'All times UTC'</span>);
fprintf(othfile, <span class="string">'\n'</span>);
fprintf(othfile, <span class="string">'\n'</span>);
fprintf(othfile, <span class="string">'-----------------  Pass Summary -- GEO LOS  ------------------\n'</span>);

<span class="comment">%Find out access periods and write to accesstimes file</span>
cnt=1;
flag=0;



<span class="keyword">for</span> k=1:othnumssiz(1)

    <span class="comment">%     if eob(othnums(k))&gt;=minE &amp;&amp; eob(othnums(k))&lt;=maxE</span>
    <span class="comment">%</span>
    <span class="comment">%     if azob(othnums(k))&gt;=laz &amp;&amp; azob(othnums(k))&lt;=raz</span>

    <span class="keyword">if</span> k&gt;1
        <span class="keyword">if</span> othnums(k)~=(othnums(k-1)+1)
            k2=k-1; <span class="comment">%will be used to find max el in window</span>
            maxEwin=max(eob(othnums(k1):othnums(k2)));
            t2=0;
            datetemp=datestr([data{1,7}(othnums(k-1)),data{1,8}(othnums(k-1)),<span class="keyword">...</span>
                data{1,9}(othnums(k-1)),data{1,10}(othnums(k-1)),data{1,11}(othnums(k-1)),data{1,12}(othnums(k-1))]);
            fprintf(othfile, <span class="string">'\t %20s \n'</span>,datetemp);
            t2=datevec(datetemp);
            elaptime=etime(t2,t1)/60;
            fprintf(othfile, <span class="string">'\t Access duration is %6.2f minutes \n'</span>,elaptime);
            fprintf(othfile, <span class="string">'\t Max elevation is is %3.1f degs \n'</span>,maxEwin);
            clear <span class="string">elaptime</span>;
            cnt=cnt+1;
            flag=0;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="keyword">if</span> k==othnumssiz(1)
        <span class="keyword">if</span> flag==1
            k2=k;
            maxEwin=max(eob(othnums(k1):othnums(k2)));
            datetemp=datestr([data{1,7}(othnums(k)),data{1,8}(othnums(k)),<span class="keyword">...</span>
                data{1,9}(othnums(k)),data{1,10}(othnums(k)),data{1,11}(othnums(k)),data{1,12}(othnums(k))]);
            fprintf(othfile, <span class="string">'\t %20s \n'</span>,datetemp);
            t2=datevec(datetemp);
            elaptime=etime(t2,t1)/60;
            fprintf(othfile, <span class="string">'\t Access duration is %6.2f minutes \n'</span>,elaptime);
            fprintf(othfile, <span class="string">'\t Max elevation is %3.1f degs \n'</span>,maxEwin);
            clear <span class="string">elaptime</span>;
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    <span class="keyword">if</span> flag==0
        k1=k;
        t1=0;
        datetemp=datestr([data{1,7}(othnums(k)),data{1,8}(othnums(k)),data{1,9}(othnums(k)),<span class="keyword">...</span>
            data{1,10}(othnums(k)),data{1,11}(othnums(k)),data{1,12}(othnums(k))]);
        t1=datevec(datetemp);
        flag=1;
        fprintf(othfile, <span class="string">'Access %2i \n'</span>,cnt);
        fprintf(othfile, <span class="string">'\t %20s \n'</span>,datetemp);
    <span class="keyword">end</span>
    <span class="comment">%     end</span>
    <span class="comment">%     end</span>
<span class="keyword">end</span>

fprintf(othfile, <span class="string">'\n'</span>);
fprintf(othfile, <span class="string">'-----------  Elevation, Slant Range, Azimuth Summary  --------\n'</span>);
fprintf(othfile, <span class="string">'\n'</span>);
fprintf(othfile, <span class="string">'            DATE        El(deg)  Slant R(km)     Az(degT) \n'</span>);
fprintf(othfile, <span class="string">'--------------------------------------------------------------\n'</span>);
<span class="comment">%Write date, elevation, sr, and az to access file</span>
cnt=1;
flag=0;

<span class="keyword">for</span> k=1:othnumssiz(1)

    <span class="keyword">if</span> k&gt;1
        <span class="keyword">if</span> othnums(k)~=(othnums(k-1)+1)
            fprintf(othfile, <span class="string">'\n'</span>);
            fprintf(acctrak, <span class="string">'nan nan nan nan \n'</span>); <span class="comment">%put in nans so each line plottedis separate</span>
            f2=0;
            cnt=cnt+1;
            flag=0;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="keyword">if</span> flag==0
        fprintf(othfile, <span class="string">'Access %2i \n'</span>,cnt);
        flag=1;
    <span class="keyword">end</span>

    <span class="comment">%Write el sr and az to summary</span>
    datef=datestr([data{1,7}(othnums(k)),data{1,8}(othnums(k)),<span class="keyword">...</span>
        data{1,9}(othnums(k)),data{1,10}(othnums(k)),data{1,11}(othnums(k)),data{1,12}(othnums(k))]);
    fprintf(othfile, <span class="string">'%20s \t %4.2f \t %8.2f \t %6.3f \n'</span>,<span class="keyword">...</span>
        datef,eob(othnums(k)),srob(othnums(k)),azob(othnums(k)));

    <span class="comment">%Write to access track file</span>
    fprintf(acctrak, <span class="string">'%5i %8.4f %8.4f %10.3f %4.2f %6.3f \t %5i %3i %3i %2i %2i %9.6f \n'</span>,<span class="keyword">...</span>
        k,LLA(othnums(k),2),LLA(othnums(k),3),LLA(othnums(k),4),<span class="keyword">...</span>
        eob(othnums(k)),azob(othnums(k)),data{1,7}(k),data{1,8}(k),data{1,9}(k),data{1,10}(k),data{1,11}(k),data{1,12}(k));


<span class="keyword">end</span>
fclose(othfile);
fclose(acctrak);



<span class="comment">%Polar plot</span>
figure(1);
outd=get(handles.outdiredit,<span class="string">'string'</span>);
outd2=strcat(outd,<span class="string">'/Access_Transit.txt'</span>);
accesstransit=importdata(outd2);
polar(accesstransit(:,6).*3.14159/180,90-accesstransit(:,5),<span class="string">'r'</span>);
title(<span class="string">'Az-El Polar Plot'</span>,<span class="string">'Fontsize'</span>,14);
outd=get(handles.outdiredit,<span class="string">'string'</span>);
pngfilename = <span class="string">'PolarPlot.png'</span>;
saveas(gcf,strcat(outd,<span class="string">'/'</span>,pngfilename));


close(mess);





<span class="comment">%</span>



<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> run_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to run (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>



<span class="keyword">function</span> tleedit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to tleedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of tleedit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of tleedit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> tleedit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to tleedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>


<span class="comment">% --- Executes on button press in selectloadtle.</span>
<span class="keyword">function</span> selectloadtle_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to selectloadtle (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
<span class="keyword">global</span> defaultbrowse

defb=defaultbrowse;
[filename, pathname] = <span class="keyword">...</span>
    uigetfile({<span class="string">'*.tle'</span>;<span class="string">'*.txt'</span>},<span class="string">'Choose file...'</span>,defb);
fname=strcat(pathname,filename);

<span class="keyword">if</span> isempty(pathname)||isempty(filename)
    errordlg(<span class="string">'Select TLE input file, .txt or .tle'</span>);
    <span class="keyword">return</span>;
<span class="keyword">end</span>
set(handles.tleedit,<span class="string">'string'</span>,fname);
a=get(handles.samedircb,<span class="string">'value'</span>);
<span class="keyword">if</span> a==1
    set(handles.outdiredit,<span class="string">'string'</span>,pathname);
<span class="keyword">end</span>

<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> selectloadtle_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to selectloadtle (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>



<span class="keyword">function</span> startedit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to startedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of startedit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of startedit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> startedit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to startedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>



<span class="keyword">function</span> stopedit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to stopedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of stopedit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of stopedit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> stopedit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to stopedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>


<span class="comment">% --- Executes on button press in samedircb.</span>
<span class="keyword">function</span> samedircb_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to samedircb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hint: get(hObject,'Value') returns toggle state of samedircb</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> samedircb_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to samedircb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>



<span class="keyword">function</span> outdiredit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to outdiredit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of outdiredit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of outdiredit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> outdiredit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to outdiredit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>


<span class="comment">% --- Executes on button press in selectout.</span>
<span class="keyword">function</span> selectout_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to selectout (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
<span class="keyword">global</span> defaultbrowse

defb=defaultbrowse;
[pathname] = uigetdir(defb);
<span class="keyword">if</span> pathname == 0
    <span class="keyword">return</span>;
<span class="keyword">end</span>
set(handles.outdiredit,<span class="string">'string'</span>,pathname);

<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> selectout_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to selectout (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>


<span class="comment">% --- Executes on button press in loadtle.</span>
<span class="keyword">function</span> loadtle_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to loadtle (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
<span class="keyword">global</span> infile outfile idebug dbgfile satrec startmfe stopmfe deltamin tleloadflag

inpath=get(handles.tleedit,<span class="string">'string'</span>);
<span class="keyword">if</span> isempty(inpath)
    errordlg(<span class="string">'Select TLE input file, .txt or .tle'</span>);
    <span class="keyword">return</span>;
<span class="keyword">end</span>
infilename = inpath;
infile = fopen(infilename, <span class="string">'r'</span>);
<span class="keyword">if</span> (infile == -1)
    fprintf(1,<span class="string">'Failed to open file: %s\n'</span>, infilename);
    <span class="keyword">return</span>;
<span class="keyword">end</span>

<span class="comment">% outfile = fopen('ManualOutput.out', 'wt');</span>

whichconst = 72;
rad = 180.0 / pi;

opsmode= <span class="string">'a'</span>;
typerun = <span class="string">'m'</span>;
<span class="keyword">if</span> (typerun == <span class="string">'m'</span>)
    <span class="comment">%     typeinput = input('input mfe, epoch (YMDHMS), or dayofyr approach, m,e,d:','s');</span>
    typeinput = <span class="string">'e'</span>;
<span class="keyword">else</span>
    typeinput = <span class="string">'e'</span>;
<span class="keyword">end</span>;

longstr1 = fgets(infile, 130);
<span class="keyword">while</span> ( (longstr1(1) == <span class="string">'#'</span>) &amp;&amp; (feof(infile) == 0) )
    longstr1 = fgets(infile, 130);
<span class="keyword">end</span>

<span class="keyword">if</span> (feof(infile) == 0)

    longstr2 = fgets(infile, 130);

    <span class="keyword">if</span> idebug
        catno = strtrim(longstr1(3:7));
        dbgfile = fopen(strcat(<span class="string">'sgp4test.dbg.'</span>,catno), <span class="string">'wt'</span>);
        fprintf(dbgfile,<span class="string">'this is the debug output\n\n'</span> );
    <span class="keyword">end</span>
    <span class="comment">%                // convert the char string to sgp4 elements</span>
    <span class="comment">%                // includes initialization of sgp4</span>
    [satrec, startmfe, stopmfe, deltamin] = twoline2rv( whichconst, <span class="keyword">...</span>
        longstr1, longstr2, typerun, typeinput);

<span class="keyword">end</span>

tleloadflag=1;

<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> loadtle_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to loadtle (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>



<span class="keyword">function</span> steptedit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to steptedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of steptedit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of steptedit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> steptedit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to steptedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>



<span class="keyword">function</span> oblat_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to oblat (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of oblat as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of oblat as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> oblat_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to oblat (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>



<span class="keyword">function</span> oblon_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to oblon (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of oblon as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of oblon as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> oblon_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to oblon (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>



<span class="keyword">function</span> obalt_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to obalt (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of obalt as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of obalt as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> obalt_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to obalt (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>


<span class="comment">% --- Executes on button press in atcb.</span>
<span class="keyword">function</span> atcb_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to atcb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hint: get(hObject,'Value') returns toggle state of atcb</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> atcb_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to atcb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>


<span class="comment">% --- Executes on button press in llacb.</span>
<span class="keyword">function</span> llacb_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to llacb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hint: get(hObject,'Value') returns toggle state of llacb</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> llacb_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to llacb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>


<span class="comment">% --- Executes on button press in acctrancb.</span>
<span class="keyword">function</span> acctrancb_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to acctrancb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hint: get(hObject,'Value') returns toggle state of acctrancb</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> acctrancb_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to acctrancb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>


<span class="comment">% --- Executes on button press in polarcb.</span>
<span class="keyword">function</span> polarcb_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to polarcb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hint: get(hObject,'Value') returns toggle state of polarcb</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> polarcb_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to polarcb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>


<span class="comment">% --- Executes on button press in sectcb.</span>
<span class="keyword">function</span> sectcb_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to sectcb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hint: get(hObject,'Value') returns toggle state of sectcb</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> sectcb_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to sectcb (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>



<span class="keyword">function</span> maxeledit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to maxeledit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of maxeledit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of maxeledit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> maxeledit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to maxeledit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>



<span class="keyword">function</span> mineledit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to mineledit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of mineledit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of mineledit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> mineledit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to mineledit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>



<span class="keyword">function</span> lazedit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to lazedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of lazedit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of lazedit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> lazedit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to lazedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>



<span class="keyword">function</span> razedit_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to razedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hints: get(hObject,'String') returns contents of razedit as text</span>
<span class="comment">%        str2double(get(hObject,'String')) returns contents of razedit as a double</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> razedit_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to razedit (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>

<span class="comment">% Hint: edit controls usually have a white background on Windows.</span>
<span class="comment">%       See ISPC and COMPUTER.</span>
<span class="keyword">if</span> ispc &amp;&amp; isequal(get(hObject,<span class="string">'BackgroundColor'</span>), get(0,<span class="string">'defaultUicontrolBackgroundColor'</span>))
    set(hObject,<span class="string">'BackgroundColor'</span>,<span class="string">'white'</span>);
<span class="keyword">end</span>


<span class="comment">% --- Executes on button press in stbutt.</span>
<span class="keyword">function</span> stbutt_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to stbutt (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>
web <span class="string">https://www.space-track.org</span> <span class="string">-browser</span>

<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> stbutt_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to stbutt (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>


<span class="comment">% --- Executes on button press in kmlext.</span>
<span class="keyword">function</span> kmlext_Callback(hObject, eventdata, handles)
<span class="comment">% hObject    handle to kmlext (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    structure with handles and user data (see GUIDATA)</span>

<span class="comment">% Hint: get(hObject,'Value') returns toggle state of kmlext</span>


<span class="comment">% --- Executes during object creation, after setting all properties.</span>
<span class="keyword">function</span> kmlext_CreateFcn(hObject, eventdata, handles)
<span class="comment">% hObject    handle to kmlext (see GCBO)</span>
<span class="comment">% eventdata  reserved - to be defined in a future version of MATLAB</span>
<span class="comment">% handles    empty - handles not created until after all CreateFcns called</span>
</pre><img vspace="5" hspace="5" src="OrbProp_01.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
% Functions compiled and GUI developed by Damon P. DeLuca, USN CIV
% Email: damondeluca@gmail.com
%
% NOTE: Output generated by this program has not been validated, other than 
% ensuring close agreement with AGI STK results.
%
% This script runs the SGP4 propagator using the manual method, afspc, with
% WGS72 ellipsoid. SPG4 output in ManualOut.out is transformed from TEME
% to ECEF using functions from David Vallado. The transformation teme2ecef
% is executed for each line of output in ManualOutput.out.
%  
% Input: See GUI. TLE input is a single two line file. 
%
% Output: 
%     Access_Summary.txt: Summary of visibility times from observers
%     location, with az/el/sr
%
%     Access_Transit.txt: Used for plotting ground tracks for passes in
%     Access_Summary.txt. Only visibility periods are included.
%     line number, lat, lon, alt (m), el(deg), az(degT), timevector
%
%     LLA_Transit.txt: Used for plotting ENTIRE ground track for period
%     specified in the GUI.
%
%     PolarPlot.png: Az-El polar plot of passes in Access_Summary.txt
%  
%SGP4 functions were % downloaded from www.celestrak.com during the week    
%of 18 JAN 2016. Credit below:
% Author:
%   Jeff Beck
%   beckja@alumni.lehigh.edu

% Version Info:
%   1.0 (051019) - Initial version from Vallado C++ version.
%   1.0 (aug 14, 2006) - update for paper
%   2.0 (apr 2, 2007) - update for manual operations
%   3.0 (3 jul, 2008) - update for opsmode operation afspc or improved
%   3.1 (2 dec, 2008) - fix tsince/1440.0 in jd update



function varargout = OrbProp(varargin)
% ORBPROP MATLAB code for OrbProp.fig
%      ORBPROP, by itself, creates a new ORBPROP or raises the existing
%      singleton*.
%
%      H = ORBPROP returns the handle to a new ORBPROP or the handle to
%      the existing singleton*.
%
%      ORBPROP('CALLBACK',hObject,eventData,handles,...) calls the local
%      function named CALLBACK in ORBPROP.M with the given input arguments.
%
%      ORBPROP('Property','Value',...) creates a new ORBPROP or raises the
%      existing singleton*.  Starting from the left, property value pairs are
%      applied to the GUI before OrbProp_OpeningFcn gets called.  An
%      unrecognized property name or invalid value makes property application
%      stop.  All inputs are passed to OrbProp_OpeningFcn via varargin.
%
%      *See GUI Options on GUIDE's Tools menu.  Choose "GUI allows only one
%      instance to run (singleton)".
%
% See also: GUIDE, GUIDATA, GUIHANDLES

% Edit the above text to modify the response to help OrbProp

% Last Modified by GUIDE v2.5 01-Feb-2016 16:48:13

% Begin initialization code - DO NOT EDIT
gui_Singleton = 1;
gui_State = struct('gui_Name',       mfilename, ...
    'gui_Singleton',  gui_Singleton, ...
    'gui_OpeningFcn', @OrbProp_OpeningFcn, ...
    'gui_OutputFcn',  @OrbProp_OutputFcn, ...
    'gui_LayoutFcn',  [] , ...
    'gui_Callback',   []);
if nargin && ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
end

if nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, varargin{:});
else
    gui_mainfcn(gui_State, varargin{:});
end
% End initialization code - DO NOT EDIT


% REPLACE_WITH_DASH_DASH- Executes just before OrbProp is made visible.
function OrbProp_OpeningFcn(hObject, eventdata, handles, varargin)
% This function has no output args, see OutputFcn.
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
% varargin   command line arguments to OrbProp (see VARARGIN)

% Choose default command line output for OrbProp
handles.output = hObject;

% Update handles structure
guidata(hObject, handles);

% UIWAIT makes OrbProp wait for user response (see UIRESUME)
% uiwait(handles.figure1);


% REPLACE_WITH_DASH_DASH- Outputs from this function are returned to the command line.
function varargout = OrbProp_OutputFcn(hObject, eventdata, handles)
% varargout  cell array for returning output args (see VARARGOUT);
% hObject    handle to figure
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Get default command line output from handles structure
varargout{1} = handles.output;


% REPLACE_WITH_DASH_DASH- Executes on button press in run.
function run_Callback(hObject, eventdata, handles)
% hObject    handle to run (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
% script testmat.m
%
% This script tests the SGP4 propagator.

% Author:
%   Jeff Beck
%   beckja@alumni.lehigh.edu

% Version Info:
%   1.0 (051019) - Initial version from Vallado C++ version.
%   1.0 (aug 14, 2006) - update for paper
%   2.0 (apr 2, 2007) - update for manual operations
%   3.0 (3 jul, 2008) - update for opsmode operation afspc or improved
%   3.1 (2 dec, 2008) - fix tsince/1440.0 in jd update

% these are set in sgp4init
global tumin mu radiusearthkm xke j2 j3 j4 j3oj2 infile outfile

global opsmode satrec startmfe stopmfe deltamin  tleloadflag

% // REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH  implementation   REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
clear adum grob azob HorEl ElSR ElGR

mess=msgbox('Please Wait...');

%   add operation smode for afspc (a) or improved (i)
% opsmode= input('input opsmode afspc a, improved i ','s');
opsmode= 'a';

%         //typerun = 'c' compare 1 year of full satcat data
%         //typerun = 'v' verification run, requires modified elm file with
%         //typerun = 'm' maunual operation- either mfe, epoch, or dayof yr
%         //              start stop and delta times

%     typerun = input('input type of run c, v, m: ','s');
if tleloadflag==0
    errordlg('Select and Load TLE!');
    return;
end

typerun = 'm';

if (typerun == 'm')
    %     typeinput = input('input mfe, epoch (YMDHMS), or dayofyr approach, m,e,d:','s');
    typeinput = 'e';
else
    typeinput = 'e';
end;

%     whichconst = input('input constants 721, 72, 84 ');

%  whichconst = input('input constants 721, 72, 84 ');
whichconst = 72;
rad = 180.0 / pi;
outfile = fopen('ManualOutput.out', 'wt');

%         // REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH setup files for operation REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
%         // input 2-line element set file
%     infilename = input('input elset filename: ','s');
% infilename = 'JASON3_SGP4_test.tle';


global idebug dbgfile

%        // REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- test simple propagation REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-

longstr1 = fgets(infile, 130);
while ( (longstr1(1) == '#') && (feof(infile) == 0) )
    longstr1 = fgets(infile, 130);
end



%         longstr2 = fgets(infile, 130);
%
%         if idebug
%             catno = strtrim(longstr1(3:7));
%             dbgfile = fopen(strcat('sgp4test.dbg.',catno), 'wt');
%             fprintf(dbgfile,'this is the debug output\n\n' );
%         end
%         %                // convert the char string to sgp4 elements
%         %                // includes initialization of sgp4
%         [satrec, startmfe, stopmfe, deltamin] = twoline2rv( whichconst, ...
%             longstr1, longstr2, typerun, typeinput);
%
%         %             fprintf(outfile, '%d xx\n', satrec.satnum);
%         %             fprintf(1,' %d\n', satrec.satnum);

%               // call the propagator to get the initial state vector value
[satrec, ro ,vo] = sgp4 (satrec,  0.0);

%             fprintf(outfile, ' %16.8f %16.8f %16.8f %16.8f %12.9f %12.9f %12.9f\n',...
%                  satrec.t,ro(1),ro(2),ro(3),vo(1),vo(2),vo(3));
%            fprintf(1, ' %16.8f %16.8f %16.8f %16.8f %12.9f %12.9f %12.9f\n',...
%                 satrec.t,ro(1),ro(2),ro(3),vo(1),vo(2),vo(3));

tsince = startmfe;

%                // check so the first value isn't written twice
if ( abs(tsince) > 1.0e-8 )
    tsince = tsince - deltamin;
end

%                // loop to perform the propagation
while ((tsince < stopmfe) && (satrec.error == 0))
    
    tsince = tsince + deltamin;
    
    if(tsince > stopmfe)
        tsince = stopmfe;
    end
    
    [satrec, ro, vo] = sgp4 (satrec,  tsince);
    if (satrec.error > 0)
        fprintf(1,'# *** error: t:= %f *** code = %3i\n', tsince, satrec.error);
    end
    
    if (satrec.error == 0)
        if ((typerun ~= 'v') && (typerun ~= 'c'))
            jd = satrec.jdsatepoch + tsince/1440.0;
            [year,mon,day,hr,minute,sec] = invjday ( jd );
            
            %Print the below for TEME state
            fprintf(outfile,...
                ' %16.8f %16.8f %16.8f %12.9f %12.9f %12.9f %5i%3i%3i %2i %2i %9.6f \n',...
                ro(1),ro(2),ro(3),vo(1),vo(2),vo(3),year,mon,day,hr,minute,sec );
            
            [p,a,ecc,incl,node,argp,nu,m,arglat,truelon,lonper ] = rv2coe (ro,vo,mu);
            %Print the below for keplar elements
            %                         fprintf(outfile, ' %14.6f %8.6f %10.5f %10.5f
            %10.5f %10.5f %10.5f %10.5f %10.5f %5i%3i%3i %2i:%2i:%9.6f \n',...
            %                             p, ecc, incl, node, argp, nu, arglat, truelon, lonper,year,mon,day,hr,minute,sec );
        else
            jd = satrec.jdsatepoch + tsince/1440.0;
            [year,mon,day,hr,minute,sec] = invjday ( jd );
            
            fprintf(outfile, ' %16.8f %16.8f %16.8f %16.8f %12.9f %12.9f %12.9f',...
                tsince,ro(1),ro(2),ro(3),vo(1),vo(2),vo(3));
            %                        fprintf(1, ' %16.8f %16.8f %16.8f %16.8f %12.9f
            %12.9f %12.9f \n',...
            %                            tsince,ro(1),ro(2),ro(3),vo(1),vo(2),vo(3));
            
            [p,a,ecc,incl,node,argp,nu,m,arglat,truelon,lonper ] = rv2coe (ro,vo,mu);
            
            fprintf(outfile, ' %14.6f %8.6f %10.5f %10.5f %10.5f %10.5f %10.5f %5i%3i%3i %2i:%2i:%9.6f \n',...
                a, ecc, incl*rad, node*rad, argp*rad, nu*rad, m*rad,year,mon,day,hr,minute,sec );
        end
    end %// if satrec.error == 0
    
end %// while propagating the orbit

if (idebug && (dbgfile ~= -1))
    fclose(dbgfile);
end





fclose(infile);
fclose(outfile);



%%%%Damon's code to calculate LLA
dat=importdata('ManualOutput.out');
datsiz=size(dat);
fileID=fopen('ManualOutput.out');
data = textscan(fileID, '%f %f %f %f %f %f %f %f %f %f %f %f %*[^\n]');
% data = textscan(fileID, '%f %f %f %f %f %f %f %f %f %*[^\n]');

%Open file for writing LLA
outd=get(handles.outdiredit,'string');
outd2=strcat(outd,'/LLA_Transit.txt');
LLAoutfile = fopen(outd2, 'wt');

%Get vars for teme2ecef
convrt = pi / (3600.0*180.0); %arc sec to rad
convrtm= (0.001*pi) /(180.0*3600.0);
xp=.0075*convrt;
yp=.2925*convrt; %xp and yp from Naval observatory, 1/26/2016
lod=0; %Excess length of day
dut1=0;
dat=0;
timezone=0;


%Use below for TEME elements
for i=1:datsiz(1)
    % [r(i,:) v(i,:)]=orb2rv(data{1,1}(i),data{1,2}(i),data{1,3}(i),data{1,4}(i),data{1,5}(i),...
    %     data{1,6}(i),data{1,7}(i),data{1,8}(i),data{1,9}(i));
    r(i,:)=[data{1,1}(i),data{1,2}(i),data{1,3}(i)];
    v(i,:)=[data{1,4}(i),data{1,5}(i),data{1,6}(i)];
    a(i,1:3)=[0, 0, 0];
    
    %Get time of the TEME line being processed
    year=data{1,7}(i);
    mon=data{1,8}(i);
    day=data{1,9}(i);
    hr=data{1,10}(i);
    min=data{1,11}(i);
    sec=data{1,12}(i);
    
    %Calc time vars for time of TEME line
    [ut1, tut1, jdut1, utc, tai, tt, ttt, jdtt, tdb, ttdb, jdtdb, tcg, jdtcg, tcb, jdtcb ] ...
        = convtime ( year, mon, day, hr, min, sec, timezone, dut1, dat );
    
    %Calc ECEF coordinate for TEME line using correct time
    [recef(i,:),vecef(i,:),aecef(i,:)] = teme2ecef  ( r(i,:)',v(i,:)',a(i,:)',ttt,jdut1,lod,xp,yp );
    recef(i,:)=recef(i,:).*1000;
    R(i,1)=i;
    R(i,2:4)=recef(i,:);
    
    LLA(i,1:4)= ecefm2LLA(R(i,1:4));
    
    timform=datestr([data{1,7}(i),data{1,8}(i),data{1,9}(i),data{1,10}(i),data{1,11}(i),data{1,12}(i)]);
    fprintf(LLAoutfile, '%5i %8.4f %8.4f %10.3f \t %5i %3i %3i %2i %2i %9.6f \n',...
        LLA(i,1),LLA(i,2),LLA(i,3),LLA(i,4),data{1,7}(i),data{1,8}(i),data{1,9}(i),data{1,10}(i),data{1,11}(i),data{1,12}(i));
end
fclose(LLAoutfile);

%Write ground track to KML file
KMLplot(LLA);

%
%   Calculations to determine visibility to TLE

wgs84=[6378.137 0.081819190842622];
wgs8443=[8504.182667 0.081819190842622]; %Used for radar horizon (4/3r earth)

vlat=str2double(get(handles.oblat,'string')); %viewer lat
vlon=str2double(get(handles.oblon,'string')); %viewer lon
valt=str2double(get(handles.obalt,'string')); %viewer alt m geodetic

if isempty(vlat)||isempty(vlon)||isempty(valt)
    errordlg('Set Observer Location');
    return;
end

%Calculate elevation and sr of object
rngvec=ones(1,datsiz(1));
vlatvec=vlat*rngvec;
vlonvec=vlon*rngvec;
valtvec=valt/1000*rngvec;
[eob,srob,adum]=elevation(vlatvec',vlonvec',valtvec',LLA(:,2),LLA(:,3),LLA(:,4)./1000,'degrees',wgs84);
[grob,azob]=distance(vlatvec',vlonvec',LLA(:,2),LLA(:,3),wgs84,'degrees');

%Calculate el of horizon from observer
[HorEl, ElSR, ElGR] = GeoHorizonEl (vlat,vlon,valt); %valt in m, SR and GR in km

% %Find lines where over the horizon
% othnums=find(eob>HorEl);
% othnumssiz=size(othnums);

%Get sector constraints
if get(handles.sectcb,'value')==1
    maxE=str2double(get(handles.maxeledit,'string'));
    minE=str2double(get(handles.mineledit,'string'));
    laz=str2double(get(handles.lazedit,'string'));
    raz=str2double(get(handles.razedit,'string'));
    
    if isempty(maxE)||isempty(minE)||isempty(laz)||isempty(raz)
        errordlg('Set sector constraints!');
        return;
    end
    
    othnums1=find(eob>=minE);
    othnums2=othnums1(find(eob(othnums1)<=maxE));
    
    if raz<laz
        
        aztmp=360+raz;
        azobtempnumschange=find(azob<=raz);
        azobtempnums=find(azob>raz);
        azobtemp(azobtempnums)=azob(azobtempnums);
        azobtemp(azobtempnumschange)=azob(azobtempnumschange)+360;
        
        othnums3=othnums2(find(azobtemp(othnums2)<=raz+360));
        othnums=othnums3(find(azobtemp(othnums3)>=laz));
        
        othnumssiz=size(othnums);
        
    else
        othnums3=othnums2(find(azob(othnums2)>=laz));
        othnums=othnums3(find(azob(othnums3)<=raz));
        
        othnumssiz=size(othnums);
        
    end
    
    
    
    
    
else %write all points above horizon
    %Find lines where over the horizon
    othnums=find(eob>HorEl);
    othnumssiz=size(othnums);
    
end

tm=clock;
tmf=datestr(clock);


%Open two files for writing
outd=get(handles.outdiredit,'string');
outd2=strcat(outd,'/Access_Transit.txt');
acctrak = fopen(outd2, 'wt');

outd=get(handles.outdiredit,'string');
outd2=strcat(outd,'/Access_Summary.txt');
othfile = fopen(outd2, 'wt');




%
% fprintf(othfile, 'Satellite Access File Created %5i/%2i/%2i %2i:%2i \n',...
%     tm(1),tm(2),tm(3),tm(4),tm(5));
fprintf(othfile, 'Satellite GEO LOS Access File Created: %20s \n',...
    tmf);
fprintf(othfile, 'Satellite ID: %5i \n \n', satrec.satnum);
fprintf(othfile, 'Viewer location: %6.4f Lat, %8.4f Lon, %6.1f m geodetic \n \n',vlat,vlon,valt);

if get(handles.sectcb,'value')==1
    fprintf(othfile, 'Sector Max El (degs): %3.1f \n', maxE);
    fprintf(othfile, 'Sector Min El (degs): %3.1f \n', minE);
    fprintf(othfile, 'Sector Left (degsT): %3.1f \n', laz);
    fprintf(othfile, 'Sector Right (degsT): %3.1f \n \n', raz);
end



fprintf(othfile, 'All times UTC');
fprintf(othfile, '\n');
fprintf(othfile, '\n');
fprintf(othfile, 'REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-  Pass Summary REPLACE_WITH_DASH_DASH GEO LOS  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH\n');

%Find out access periods and write to accesstimes file
cnt=1;
flag=0;



for k=1:othnumssiz(1)
    
    %     if eob(othnums(k))>=minE && eob(othnums(k))<=maxE
    %
    %     if azob(othnums(k))>=laz && azob(othnums(k))<=raz
    
    if k>1
        if othnums(k)~=(othnums(k-1)+1)
            k2=k-1; %will be used to find max el in window
            maxEwin=max(eob(othnums(k1):othnums(k2)));
            t2=0;
            datetemp=datestr([data{1,7}(othnums(k-1)),data{1,8}(othnums(k-1)),...
                data{1,9}(othnums(k-1)),data{1,10}(othnums(k-1)),data{1,11}(othnums(k-1)),data{1,12}(othnums(k-1))]);
            fprintf(othfile, '\t %20s \n',datetemp);
            t2=datevec(datetemp);
            elaptime=etime(t2,t1)/60;
            fprintf(othfile, '\t Access duration is %6.2f minutes \n',elaptime);
            fprintf(othfile, '\t Max elevation is is %3.1f degs \n',maxEwin);
            clear elaptime;
            cnt=cnt+1;
            flag=0;
        end
    end
    if k==othnumssiz(1)
        if flag==1
            k2=k;
            maxEwin=max(eob(othnums(k1):othnums(k2)));
            datetemp=datestr([data{1,7}(othnums(k)),data{1,8}(othnums(k)),...
                data{1,9}(othnums(k)),data{1,10}(othnums(k)),data{1,11}(othnums(k)),data{1,12}(othnums(k))]);
            fprintf(othfile, '\t %20s \n',datetemp);
            t2=datevec(datetemp);
            elaptime=etime(t2,t1)/60;
            fprintf(othfile, '\t Access duration is %6.2f minutes \n',elaptime);
            fprintf(othfile, '\t Max elevation is %3.1f degs \n',maxEwin);
            clear elaptime;
        end
    end
    
    if flag==0
        k1=k;
        t1=0;
        datetemp=datestr([data{1,7}(othnums(k)),data{1,8}(othnums(k)),data{1,9}(othnums(k)),...
            data{1,10}(othnums(k)),data{1,11}(othnums(k)),data{1,12}(othnums(k))]);
        t1=datevec(datetemp);
        flag=1;
        fprintf(othfile, 'Access %2i \n',cnt);
        fprintf(othfile, '\t %20s \n',datetemp);
    end
    %     end
    %     end
end

fprintf(othfile, '\n');
fprintf(othfile, 'REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-  Elevation, Slant Range, Azimuth Summary  REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH\n');
fprintf(othfile, '\n');
fprintf(othfile, '            DATE        El(deg)  Slant R(km)     Az(degT) \n');
fprintf(othfile, 'REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH\n');
%Write date, elevation, sr, and az to access file
cnt=1;
flag=0;

for k=1:othnumssiz(1)
    
    if k>1
        if othnums(k)~=(othnums(k-1)+1)
            fprintf(othfile, '\n');
            fprintf(acctrak, 'nan nan nan nan \n'); %put in nans so each line plottedis separate
            f2=0;
            cnt=cnt+1;
            flag=0;
        end
    end
    if flag==0
        fprintf(othfile, 'Access %2i \n',cnt);
        flag=1;
    end
    
    %Write el sr and az to summary
    datef=datestr([data{1,7}(othnums(k)),data{1,8}(othnums(k)),...
        data{1,9}(othnums(k)),data{1,10}(othnums(k)),data{1,11}(othnums(k)),data{1,12}(othnums(k))]);
    fprintf(othfile, '%20s \t %4.2f \t %8.2f \t %6.3f \n',...
        datef,eob(othnums(k)),srob(othnums(k)),azob(othnums(k)));
    
    %Write to access track file
    fprintf(acctrak, '%5i %8.4f %8.4f %10.3f %4.2f %6.3f \t %5i %3i %3i %2i %2i %9.6f \n',...
        k,LLA(othnums(k),2),LLA(othnums(k),3),LLA(othnums(k),4),...
        eob(othnums(k)),azob(othnums(k)),data{1,7}(k),data{1,8}(k),data{1,9}(k),data{1,10}(k),data{1,11}(k),data{1,12}(k));
    
    
end
fclose(othfile);
fclose(acctrak);



%Polar plot
figure(1);
outd=get(handles.outdiredit,'string');
outd2=strcat(outd,'/Access_Transit.txt');
accesstransit=importdata(outd2);
polar(accesstransit(:,6).*3.14159/180,90-accesstransit(:,5),'r');
title('Az-El Polar Plot','Fontsize',14);
outd=get(handles.outdiredit,'string');
pngfilename = 'PolarPlot.png';
saveas(gcf,strcat(outd,'/',pngfilename));


close(mess);





%



% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function run_CreateFcn(hObject, eventdata, handles)
% hObject    handle to run (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called



function tleedit_Callback(hObject, eventdata, handles)
% hObject    handle to tleedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of tleedit as text
%        str2double(get(hObject,'String')) returns contents of tleedit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function tleedit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to tleedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% REPLACE_WITH_DASH_DASH- Executes on button press in selectloadtle.
function selectloadtle_Callback(hObject, eventdata, handles)
% hObject    handle to selectloadtle (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
global defaultbrowse

defb=defaultbrowse;
[filename, pathname] = ...
    uigetfile({'*.tle';'*.txt'},'Choose file...',defb);
fname=strcat(pathname,filename);

if isempty(pathname)||isempty(filename)
    errordlg('Select TLE input file, .txt or .tle');
    return;
end
set(handles.tleedit,'string',fname);
a=get(handles.samedircb,'value');
if a==1
    set(handles.outdiredit,'string',pathname);
end

% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function selectloadtle_CreateFcn(hObject, eventdata, handles)
% hObject    handle to selectloadtle (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called



function startedit_Callback(hObject, eventdata, handles)
% hObject    handle to startedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of startedit as text
%        str2double(get(hObject,'String')) returns contents of startedit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function startedit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to startedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function stopedit_Callback(hObject, eventdata, handles)
% hObject    handle to stopedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of stopedit as text
%        str2double(get(hObject,'String')) returns contents of stopedit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function stopedit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to stopedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% REPLACE_WITH_DASH_DASH- Executes on button press in samedircb.
function samedircb_Callback(hObject, eventdata, handles)
% hObject    handle to samedircb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of samedircb


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function samedircb_CreateFcn(hObject, eventdata, handles)
% hObject    handle to samedircb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called



function outdiredit_Callback(hObject, eventdata, handles)
% hObject    handle to outdiredit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of outdiredit as text
%        str2double(get(hObject,'String')) returns contents of outdiredit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function outdiredit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to outdiredit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% REPLACE_WITH_DASH_DASH- Executes on button press in selectout.
function selectout_Callback(hObject, eventdata, handles)
% hObject    handle to selectout (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
global defaultbrowse

defb=defaultbrowse;
[pathname] = uigetdir(defb);
if pathname == 0
    return;
end
set(handles.outdiredit,'string',pathname);

% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function selectout_CreateFcn(hObject, eventdata, handles)
% hObject    handle to selectout (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called


% REPLACE_WITH_DASH_DASH- Executes on button press in loadtle.
function loadtle_Callback(hObject, eventdata, handles)
% hObject    handle to loadtle (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
global infile outfile idebug dbgfile satrec startmfe stopmfe deltamin tleloadflag

inpath=get(handles.tleedit,'string');
if isempty(inpath)
    errordlg('Select TLE input file, .txt or .tle');
    return;
end
infilename = inpath;
infile = fopen(infilename, 'r');
if (infile == -1)
    fprintf(1,'Failed to open file: %s\n', infilename);
    return;
end

% outfile = fopen('ManualOutput.out', 'wt');

whichconst = 72;
rad = 180.0 / pi;

opsmode= 'a';
typerun = 'm';
if (typerun == 'm')
    %     typeinput = input('input mfe, epoch (YMDHMS), or dayofyr approach, m,e,d:','s');
    typeinput = 'e';
else
    typeinput = 'e';
end;

longstr1 = fgets(infile, 130);
while ( (longstr1(1) == '#') && (feof(infile) == 0) )
    longstr1 = fgets(infile, 130);
end

if (feof(infile) == 0)
    
    longstr2 = fgets(infile, 130);
    
    if idebug
        catno = strtrim(longstr1(3:7));
        dbgfile = fopen(strcat('sgp4test.dbg.',catno), 'wt');
        fprintf(dbgfile,'this is the debug output\n\n' );
    end
    %                // convert the char string to sgp4 elements
    %                // includes initialization of sgp4
    [satrec, startmfe, stopmfe, deltamin] = twoline2rv( whichconst, ...
        longstr1, longstr2, typerun, typeinput);
    
end

tleloadflag=1;

% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function loadtle_CreateFcn(hObject, eventdata, handles)
% hObject    handle to loadtle (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called



function steptedit_Callback(hObject, eventdata, handles)
% hObject    handle to steptedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of steptedit as text
%        str2double(get(hObject,'String')) returns contents of steptedit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function steptedit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to steptedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function oblat_Callback(hObject, eventdata, handles)
% hObject    handle to oblat (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of oblat as text
%        str2double(get(hObject,'String')) returns contents of oblat as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function oblat_CreateFcn(hObject, eventdata, handles)
% hObject    handle to oblat (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function oblon_Callback(hObject, eventdata, handles)
% hObject    handle to oblon (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of oblon as text
%        str2double(get(hObject,'String')) returns contents of oblon as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function oblon_CreateFcn(hObject, eventdata, handles)
% hObject    handle to oblon (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function obalt_Callback(hObject, eventdata, handles)
% hObject    handle to obalt (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of obalt as text
%        str2double(get(hObject,'String')) returns contents of obalt as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function obalt_CreateFcn(hObject, eventdata, handles)
% hObject    handle to obalt (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% REPLACE_WITH_DASH_DASH- Executes on button press in atcb.
function atcb_Callback(hObject, eventdata, handles)
% hObject    handle to atcb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of atcb


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function atcb_CreateFcn(hObject, eventdata, handles)
% hObject    handle to atcb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called


% REPLACE_WITH_DASH_DASH- Executes on button press in llacb.
function llacb_Callback(hObject, eventdata, handles)
% hObject    handle to llacb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of llacb


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function llacb_CreateFcn(hObject, eventdata, handles)
% hObject    handle to llacb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called


% REPLACE_WITH_DASH_DASH- Executes on button press in acctrancb.
function acctrancb_Callback(hObject, eventdata, handles)
% hObject    handle to acctrancb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of acctrancb


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function acctrancb_CreateFcn(hObject, eventdata, handles)
% hObject    handle to acctrancb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called


% REPLACE_WITH_DASH_DASH- Executes on button press in polarcb.
function polarcb_Callback(hObject, eventdata, handles)
% hObject    handle to polarcb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of polarcb


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function polarcb_CreateFcn(hObject, eventdata, handles)
% hObject    handle to polarcb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called


% REPLACE_WITH_DASH_DASH- Executes on button press in sectcb.
function sectcb_Callback(hObject, eventdata, handles)
% hObject    handle to sectcb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of sectcb


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function sectcb_CreateFcn(hObject, eventdata, handles)
% hObject    handle to sectcb (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called



function maxeledit_Callback(hObject, eventdata, handles)
% hObject    handle to maxeledit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of maxeledit as text
%        str2double(get(hObject,'String')) returns contents of maxeledit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function maxeledit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to maxeledit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function mineledit_Callback(hObject, eventdata, handles)
% hObject    handle to mineledit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of mineledit as text
%        str2double(get(hObject,'String')) returns contents of mineledit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function mineledit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to mineledit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function lazedit_Callback(hObject, eventdata, handles)
% hObject    handle to lazedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of lazedit as text
%        str2double(get(hObject,'String')) returns contents of lazedit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function lazedit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to lazedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end



function razedit_Callback(hObject, eventdata, handles)
% hObject    handle to razedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hints: get(hObject,'String') returns contents of razedit as text
%        str2double(get(hObject,'String')) returns contents of razedit as a double


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function razedit_CreateFcn(hObject, eventdata, handles)
% hObject    handle to razedit (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

% Hint: edit controls usually have a white background on Windows.
%       See ISPC and COMPUTER.
if ispc && isequal(get(hObject,'BackgroundColor'), get(0,'defaultUicontrolBackgroundColor'))
    set(hObject,'BackgroundColor','white');
end


% REPLACE_WITH_DASH_DASH- Executes on button press in stbutt.
function stbutt_Callback(hObject, eventdata, handles)
% hObject    handle to stbutt (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)
web https://www.space-track.org -browser

% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function stbutt_CreateFcn(hObject, eventdata, handles)
% hObject    handle to stbutt (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called


% REPLACE_WITH_DASH_DASH- Executes on button press in kmlext.
function kmlext_Callback(hObject, eventdata, handles)
% hObject    handle to kmlext (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    structure with handles and user data (see GUIDATA)

% Hint: get(hObject,'Value') returns toggle state of kmlext


% REPLACE_WITH_DASH_DASH- Executes during object creation, after setting all properties.
function kmlext_CreateFcn(hObject, eventdata, handles)
% hObject    handle to kmlext (see GCBO)
% eventdata  reserved - to be defined in a future version of MATLAB
% handles    empty - handles not created until after all CreateFcns called

##### SOURCE END #####
--></body></html>